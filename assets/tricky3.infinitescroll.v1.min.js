!function(e){e.fn.TrickyInfiniteScroll=function(t){var a={ParentProductsWrapper:null,IsRequestOn:!1,NextPageLink:null,PreviousPageLink:null,InitialNextPageLink:null,NeedToLoadOnlyNextPages:!1,NeedToLoadOnlyPreviousPages:!1,NeedToLoadBothPreviousAndNextPages:!1,UrlToLoad:null,UpdateHashOnWindowScrollLoaded:!1,Opts:{Selectors:{ParentProductsWrapper:".collection-matrix",Product:"li",NextPageLink:"#NextPaginationLink a",PreviousPageLink:"#PreviousPaginationLink a"},PageQueryStringKey:"page",WaitForImagesToBeLoaded:!1,EnableHasherModule:!1,CallBack:function(){},CallBackOnPageLoad:function(){},CallBackBeforePageLoad:function(){}}};a.Opts=e.extend(a.Opts,t),a.ParentProductsWrapper=this,a.NextPageLink=e(a.Opts.Selectors.NextPageLink),a.InitialNextPageLink=a.NextPageLink,a.PreviousPageLink=e(a.Opts.Selectors.PreviousPageLink),a.NeedToLoadOnlyNextPages=0==a.PreviousPageLink.length&&1==a.NextPageLink.length,a.NeedToLoadOnlyPreviousPages=1==a.PreviousPageLink.length&&0==a.NextPageLink.length,a.NeedToLoadBothPreviousAndNextPages=1==a.PreviousPageLink.length&&1==a.NextPageLink.length,a.UpdateHashOnWindowScrollLoaded=!1;var o=function(){if(null!=a.NextPageLink&&1==a.NextPageLink.length||null!=a.PreviousPageLink&&1==a.PreviousPageLink.length){var t=e(window).scrollTop(),o=t+e(window).height(),r=e(a.Opts.Selectors.Product+":visible:last",a.ParentProductsWrapper).offset().top,l=r+e(a.Opts.Selectors.Product+":visible:last",a.ParentProductsWrapper).height();!a.IsRequestOn&&o>=l&&r>=t&&(a.Opts.CallBackBeforePageLoad(),i.SetUpUrlToLoad(),e.get(a.UrlToLoad,n),a.IsRequestOn=!0)}else a.Opts.CallBack(),e(window).unbind("scroll.trickyInfiniteScroll")},n=function(t){var o=e(t).find(a.Opts.Selectors.ParentProductsWrapper);if(a.NextPageLink=e(t).find(a.Opts.Selectors.NextPageLink),a.PreviousPageLink=e(t).find(a.Opts.Selectors.PreviousPageLink),a.Opts.WaitForImagesToBeLoaded){var n=e("img",o).length,l=1,s=!1;e("img",o).load(function(){l++,l>=n&&a.IsRequestOn&&!s&&(i.FireAllCallBacks(o),s=!0)}).each(function(){this.complete&&e(this).load()})}else i.FireAllCallBacks(o);a.Opts.EnableHasherModule&&!a.UpdateHashOnWindowScrollLoaded&&(a.UpdateHashOnWindowScrollLoaded=!0,r.UpdateHashOnWindowScrollStopped())},i={FireAllCallBacks:function(e){a.Opts.EnableHasherModule&&r.HashUrlAndAddPageAttributesToProducts(e),a.ParentProductsWrapper.append(e.html()),i.ReloadPageLinksObjectsAndVariables(),a.Opts.CallBackOnPageLoad(),a.IsRequestOn=!1},AddPageNumberAttributesToExistingProducts:function(){var t=i.GetParameterByName(window.location.href,a.Opts.PageQueryStringKey);e(a.Opts.Selectors.Product,a.ParentProductsWrapper).attr("data-pagenumber",""==t?1:t)},GetParameterByName:function(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a=new RegExp("[\\?&]"+t+"=([^&#]*)"),o=a.exec(e);return null==o?"":decodeURIComponent(o[1].replace(/\+/g," "))},ReloadPageLinksObjectsAndVariables:function(){a.NeedToLoadOnlyNextPages&&0==a.NextPageLink.length&&(a.NeedToLoadOnlyNextPages=!1,a.PreviousPageLink=a.NextPageLink=null),a.NeedToLoadOnlyPreviousPages&&0==a.PreviousPageLink.length&&(a.NeedToLoadOnlyPreviousPages=!1,a.NextPageLink=a.PreviousPageLink=null)},SetUpUrlToLoad:function(){a.NeedToLoadOnlyPreviousPages&&(a.UrlToLoad=a.PreviousPageLink.attr("href")),a.NeedToLoadOnlyNextPages&&(a.UrlToLoad=a.NextPageLink.attr("href")),a.NeedToLoadBothPreviousAndNextPages&&(a.PreviousPageLink.length?a.UrlToLoad=a.PreviousPageLink.attr("href"):null!=a.InitialNextPageLink&&(a.UrlToLoad=a.InitialNextPageLink.attr("href"),a.NeedToLoadOnlyNextPages=!0,a.NeedToLoadBothPreviousAndNextPages=!1))}},r={CheckHashAndReloadPageIfNeeded:function(){var e=window.location.hash;if(e&&-1!=e.indexOf(a.Opts.PageQueryStringKey)){var t=e.split("=")[1],o=window.location.href.replace(e,""),n=window.location.search;if(""==n)window.location.href=o+"?"+a.Opts.PageQueryStringKey+"="+t;else{for(var i=n.replace("?","").split("&"),r="",l=0;l<i.length;l++)-1==i[l].indexOf(a.Opts.PageQueryStringKey+"=")&&(r+=i[l]+"&");var o=window.location.href.replace(window.location.hash,"").replace(window.location.search,"");o=""!=r?o+"?"+r+a.Opts.PageQueryStringKey+"="+t:o+"?"+a.Opts.PageQueryStringKey+"="+t,window.location.href=o}}},HashUrlAndAddPageAttributesToProducts:function(t){var o=i.GetParameterByName(a.UrlToLoad,a.Opts.PageQueryStringKey);o&&(e(a.Opts.Selectors.Product,t).attr("data-pagenumber",o),window.location.hash=a.Opts.PageQueryStringKey+"="+o)},UpdateHashOnWindowScrollStopped:function(){e(window).scrollStopped(function(){e(a.Opts.Selectors.Product,a.ParentProductsWrapper).each(function(){e(this).visible(!0)?(e(this).addClass("in-viewport"),e(this).removeClass("not-in-viewport")):(e(this).removeClass("in-viewport"),e(this).addClass("not-in-viewport"))});var t=e(a.Opts.Selectors.Product+".in-viewport",a.ParentProductsWrapper).first();1==t.length&&(window.location.hash=a.Opts.PageQueryStringKey+"="+t.attr("data-pagenumber"))})}};a.Opts.EnableHasherModule&&r.CheckHashAndReloadPageIfNeeded(),i.AddPageNumberAttributesToExistingProducts(),e(window).bind("scroll.trickyInfiniteScroll",o)}}(jQuery),function(e){e.fn.scrollStopped=function(t){e(this).scroll(function(){var a=this,o=e(a);o.data("scrollTimeout")&&clearTimeout(o.data("scrollTimeout")),o.data("scrollTimeout",setTimeout(t,250,a))})}}(jQuery),function(e){e.fn.visible=function(t,a,o){var n=e(this).eq(0),i=n.get(0),r=e(window),l=r.scrollTop(),s=l+r.height(),d=r.scrollLeft(),P=d+r.width(),c=n.offset().top,u=c+n.height(),g=n.offset().left,p=g+n.width(),h=t===!0?u:c,L=t===!0?c:u,f=t===!0?p:g,O=t===!0?g:p,k=a===!0?i.offsetWidth*i.offsetHeight:!0,o=o?o:"both";return"both"===o?!!k&&s>=L&&h>=l&&P>=O&&f>=d:"vertical"===o?!!k&&s>=L&&h>=l:"horizontal"===o?!!k&&P>=O&&f>=d:void 0}}(jQuery);